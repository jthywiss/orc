<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4.4.&nbsp;Exception Handling</title><meta content="DocBook XSL Stylesheets V1.74.0" name="generator"><link rel="home" href="index.html" title="Orc User Guide v0.9.9"><link rel="up" href="ch04.html" title="Chapter&nbsp;4.&nbsp;Type Checking"><link rel="prev" href="ch04s03.html" title="4.3.&nbsp;Interacting with Java"><link rel="next" href="ch04s05.html" title="4.5.&nbsp;Syntax of Typed Orc"><link href="/orchard/orc.css" type="text/css" rel="stylesheet"><link href="style.css" type="text/css" rel="stylesheet"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3">4.4.&nbsp;Exception Handling</th></tr><tr><td align="left" width="20%"><a accesskey="p" href="ch04s03.html">Prev</a>&nbsp;</td><th align="center" width="60%">Chapter&nbsp;4.&nbsp;Type Checking</th><td align="right" width="20%">&nbsp;<a accesskey="n" href="ch04s05.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="N11AD0"></a>4.4.&nbsp;Exception Handling</h2></div></div></div><p>
The Orc typechecker currently provides only partial support for the typechecking of the
<code class="code"><span class="hl-keyword">try</span></code>/<code class="code"><span class="hl-keyword">catch</span></code> <a class="link" href="">exception handling mechanism</a>.
</p><p>
The expression <code class="code"><span class="hl-keyword">throw</span></code> E always has type <code class="code"><span class="hl-variable">Bot</span></code>. E is typechecked
to ensure that it does indeed have some type, but that type is ignored, since a throw expression
will raise exceptions rather than publish values.
</p><p>
In the expression <code class="code"><span class="hl-keyword">try</span></code> E <code class="code"><span class="hl-keyword">catch</span>(</code>P<code class="code">)</code> F, the type of the
whole expression is the type of E. The type of the handler body F must be the same as, or
some subtype of, the type of E.
</p><p>
The expression F is checked without information about the
type of the exception value bound by <code class="code"><span class="hl-variable">P</span></code>; the typechecker uses the type <code class="code"><span class="hl-variable">Bot</span></code>.
This is a hole in the typechecker; it is possible to write an exception handler which uses
its argument inappropriately and generates a runtime type error. For the moment, it is the
programmer's responsibility to ensure that a handler uses its argument appropriately; we are
currently investigating possible solutions to this problem. 
</p><p>
In practice this weakness is rarely a problem, because the common use case for <code class="code"><span class="hl-keyword">catch</span></code>
handler arguments is to match against a Java exception class:

<pre class="programlisting">
<span class="hl-keyword">class</span> <span class="hl-variable">FileNotFoundException</span> = <span class="hl-variable">java</span>.<span class="hl-variable">io</span>.<span class="hl-variable">FileNotFoundException</span>
<span class="hl-keyword">try</span>
  ...
<span class="hl-keyword">catch</span> (<span class="hl-site">FileNotFoundException</span>(<span class="hl-variable">e</span>))
  ...
</pre>

Since this effectively performs a cast, the variable <code class="code"><span class="hl-variable">e</span></code> is given the appropriate type
<code class="code"><span class="hl-variable">FileNotFoundException</span></code>, and the typechecker behaves correctly in this case.

</p></div><script type="text/javascript" src="/orchard/orc.js"></script><div class="navfooter"><hr><table summary="Navigation footer" width="100%"><tr><td align="left" width="40%"><a accesskey="p" href="ch04s03.html">Prev</a>&nbsp;</td><td align="center" width="20%"><a accesskey="u" href="ch04.html">Up</a></td><td align="right" width="40%">&nbsp;<a accesskey="n" href="ch04s05.html">Next</a></td></tr><tr><td valign="top" align="left" width="40%">4.3.&nbsp;Interacting with Java&nbsp;</td><td align="center" width="20%"><a accesskey="h" href="index.html">Home</a></td><td valign="top" align="right" width="40%">&nbsp;4.5.&nbsp;Syntax of Typed Orc</td></tr></table></div></body></html>