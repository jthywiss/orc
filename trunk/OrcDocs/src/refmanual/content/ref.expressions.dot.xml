<?xml version="1.0" encoding="UTF-8"?>
<!-- ref.expressions.dot.xml - DocBook source for an Orc reference manual section

     $Id$

     Copyright (c) 2011 The University of Texas at Austin. All rights reserved.

     Use and redistribution of this file is governed by the license terms in
     the LICENSE file found in the project's top-level directory and also found at
     URL: http://orc.csres.utexas.edu/license.shtml .
  -->

<!-- Dot Access -->
	<section xml:id="ref.expressions.dot">
		<title>Dot Access</title>
		
		<para>
			A <firstterm>dot access</firstterm> is an expression which retrieves a named <firstterm>member</firstterm> of a value.
			It consists of a <firstterm>target</firstterm> expression <replaceable>E</replaceable> and a <firstterm>key</firstterm> <replaceable>K</replaceable>.
			First, <replaceable>E</replaceable> is <link linkend="ref.concepts.deflate"><ind>deflated</ind></link> to a value <replaceable>v</replaceable>.
			If the value <replaceable>v</replaceable> has a member named <replaceable>K</replaceable>, that member
			is published. Otherwise, the expression halts.
		</para>
			
		<para>
			Not all values have members. 
			<link linkend="ref.data.record"><ind>Records</ind></link> have members, as do many <ind>sites</ind>.
			A value created by an <link linkend="ref.declarations.class"><ind>imported class</ind></link> has
			a member for each method and <ind>field</ind> of the corresponding class.
			A value created by a <link linkend="ref.declarations.class"><ind>defined class</ind></link> has
			a member for each <code>def</code> and <code>val</code> declaration in the class.
		</para>
			
		<para>
			Like many expressions in Orc, a dot access is simply another form of <ind>site call</ind>. The key
			is converted to a special value and passed to the site call as the only argument. The
			site call <ind>publishes</ind> the member named by the key if it exists, and <ind>halts</ind> otherwise.
		</para>
		
		<section xml:id="ref.expressions.dot.syntax">
	  <title>Syntax</title>
	  <para>
	    <productionset>
	    	<productionrecap linkend="ebnf.expression.dot"/>
	    </productionset>
	  </para>
	  </section>
	  
	  <section xml:id="ref.expressions.dot.type">
	    <title>Type</title>
	    <para>
	    	If the target expression <replaceable>E</replaceable> has the <ind>record type</ind> <code>{.</code> <replaceable>K<subscript>0</subscript></replaceable> <code>::</code> <replaceable>T<subscript>0</subscript></replaceable> <code>,</code> &#x2026; <code>,</code> <replaceable>K<subscript>n</subscript></replaceable> <code>::</code> <replaceable>T<subscript>n</subscript></replaceable> <code>.}</code>,
	    	then the dot access <replaceable>E</replaceable><code>.</code><replaceable>K<subscript>i</subscript></replaceable> has type <replaceable>T<subscript>i</subscript></replaceable>.
	    </para>
	    <para>
	    	If the target has a <ind>Java</ind> class or object type, the <link linkend="ref.types.java">usual Java typing rules</link> apply.
	    </para>
	    <para>
	      If the target is a site, then the type of the dot access is determined entirely by the site, like any other site call.
	    </para>
	  </section>
	  
		<section xml:id="ref.expressions.dot.examples">
		  <title>Examples</title>

		  <example xml:id="ref.expressions.dot.examples.recordaccess"><title>Record Access</title>
<programlisting language="orc-demo"><![CDATA[
{- Add two members of a record -} 

val displacement = {. dx = 3.0, dy = 0.3, dz = 1.1 .}

displacement.dx + displacement.dy

{-
OUTPUT:
3.3
-}
]]></programlisting>
		  </example>
		  
		  <example xml:id="ref.expressions.dot.examples.channelops"><title>Channel Operations</title>
<programlisting language="orc-demo"><![CDATA[
{- Create a channel, and perform some operations on it. -}

val c = Buffer()

  c.get() >x> c.put(x+1) >> stop
| c.get() >y> c.put(y*2) >> stop
| c.put(3) >> stop
  ;
  c.get()

{-
OUTPUT:
7

OUTPUT:
8
-}
]]></programlisting>
		  </example>
		  
		</section>
		  		
		<section xml:id="ref.expressions.dot.links">
		  <title>Related Links</title>
		  
		  <informaltable frame="none">
	  		<tgroup cols="1" align="left">
	    	<thead>
	      		<row>
	        		<entry align="left">Related Reference Topics</entry>
	        	</row>
	    	</thead>
	    	<tbody valign="top">
	     		<row>
	        		<entry><itemizedlist>
	          			<listitem>TODO</listitem>
	        		</itemizedlist></entry>
	        	</row>
	    	</tbody>
	  		</tgroup>
		  </informaltable>
		  
		  <informaltable frame="none">
	  		<tgroup cols="1" align="left">
	    	<thead>
	      		<row>
	        		<entry align="left">Related Tutorial Sections</entry>
	        	</row>
	    	</thead>
	    	<tbody valign="top">
	     		<row>
	        		<entry><itemizedlist>
          				<listitem>TODO</listitem>
        			</itemizedlist></entry>
	        	</row>
	    	</tbody>
	  		</tgroup>
		  </informaltable>

	  </section>
	</section>
