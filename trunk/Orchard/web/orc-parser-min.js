Editor.Parser=(function(){var B={"{-":L,"<:":G,":>":G,"<=":G,">=":G,"||":G,"&&":G,"--":H,"/=":G};var C={"{":G,"<":G,">":G,"|":J,":":G,"&":G,"-":G,"/":G,";":J,"}":G,",":G,"!":G,"=":G,"(":G,")":G,".":G,"[":G,"]":G,"~":G,"+":G,"*":G,"%":G,"@":G,'"':N};var E=matcher(/[\w_0-9]/);var F=matcher(/[0-9]/);function M(R,Q){function S(T){return T!="\n"&&/^[\s\u00a0]$/.test(T)}function O(T){T.value=T.content=(T.content||"")+R.get();return T}function P(){var T;if(!R.more()){throw StopIteration}if(R.peek()=="\n"){R.next();return O({type:"whitespace",style:"whitespace"})}else{if(R.applies(S)){R.nextWhile(S);return O({type:"whitespace",style:"whitespace"})}else{while(!T){T=Q(R,function(U){Q=U})}return O(T)}}}return{next:P,state:Q}}function D(R,S){var Q=R.next();var P=Q+R.peek();var O;if(O=B[P]){R.next();return O(R,S,P)}else{if(O=C[Q]){return O(R,S,Q)}else{if(F(Q)){return K(R,S,Q)}else{return I(R,S,Q)}}}}function G(Q,P,O){return{type:O,style:"operator"}}function J(Q,P,O){return{type:O,style:"combinator"}}function K(Q,O,P){Q.nextWhile(F);if(Q.peek()=="."){Q.next();Q.nextWhile(F)}if(Q.peek()=="E"||Q.peek()=="e"){Q.next();switch(Q.peek()){case"-":case"+":Q.next()}Q.nextWhile(F)}return{type:"number",style:"literal"}}function I(Q,O,P){Q.nextWhile(E);var R=Q.get();switch(R){case"true":case"false":return{type:"boolean",content:R,style:"literal"};case"val":case"def":case"as":case"include":case"site":case"class":case"null":case"stop":case"if":case"then":case"else":case"signal":case"lambda":return{type:R,content:R,style:"keyword"};default:return{type:"variable",content:R,style:"variable"}}}function N(Q,R,O){R(N);while(!Q.endOfLine()){var P=Q.next();if(P=='"'){R(D);break}else{if(P=="\\"){Q.next()}}}return{type:"string",style:"literal"}}function L(P,Q){Q(L);while(!P.endOfLine()){var O=P.next();if(O=="-"&&P.peek()=="}"){P.next();Q(D);break}}return{type:"comment",style:"comment"}}function H(P,Q,O){while(!P.endOfLine()){P.next()}return{type:"comment",style:"comment"}}function A(O){var Y=M(O,D);var T=[];var W=0;var a=null;var Q=false;var P=false;function Z(){W=0}function U(){Z();if(T.length){return T.shift()}else{return Y.next()}}function X(){try{if(T.length>W){return T[W++]}else{T.push(Y.next());return X()}}catch(b){}}function V(){var b=U();if(Q){b.style+=" pattern"}if(b.content=="\n"){if(a==null){a=0}var d=a;b.indentation=function(e){return d};a=null}else{if(b.type=="variable"){Z();do{var c=X();if(!c){break}if(c.type=="("){b.style="site";break}}while(c.type=="whitespace")}if(b.type=="<"||b.type==">"){if(Q){b.style="combinator";Q=false}else{if(P){Z();var c=X();if(c&&c.type!="whitespace"){b.style="combinator";Q=true}}}}if(a==null){if(b.type=="whitespace"){a=b.value.length}else{a=0}}}P=(b.type=="whitespace");return b}function S(){var c=Y.state;var b=Q;return function(d){Y=M(d,c);Q=b;T=[];W=0;a=null;P=true;return R}}var R={next:V,copy:S};return R}return{make:A}})();