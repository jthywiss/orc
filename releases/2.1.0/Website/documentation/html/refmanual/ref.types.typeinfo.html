<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>9.4.&nbsp;Adding Type Information</title><meta content="DocBook XSL-NS Stylesheets V1.76.1" name="generator"><link rel="home" href="index.html" title="Orc Reference Manual v2.1.0"><link rel="up" href="ref.types.html" title="Chapter&nbsp;9.&nbsp;Type System"><link rel="prev" href="ref.types.subtyping.html" title="9.3.&nbsp;Subtyping"><link rel="next" href="ref.types.override.html" title="9.5.&nbsp;Type Override"><link rel="copyright" href="legalnotice.html" title="License and Grant Information"><link xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" type="text/css" rel="stylesheet" href="/orchard/orc.css"><link xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" href="style.css" type="text/css" rel="stylesheet"><script xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" type="text/javascript">
// Expandable content script from flooble.com.
// For more information please visit:
// http://www.flooble.com/scripts/expand.php
// Copyright 2002 Animus Pactum Consulting Inc.
//----------------------------------------------
function toggle(link, divId) {
	var lText = link.innerHTML;
	var d = document.getElementById(divId);
	if (lText == '+') {
		link.innerHTML = '&#8722;';
		d.style.display = 'block';
	} else {
		link.innerHTML = '+';
		d.style.display = 'none';
	}
}
</script></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3"><a accesskey="h" href="index.html"><img src="images/home.gif" alt="Table of Contents"></a></th></tr><tr><td align="left" width="20%"><a accesskey="p" href="ref.types.subtyping.html"><img src="images/prev.gif" alt="Prev"></a>&nbsp;</td><th align="center" width="60%"><a accesskey="u" href="ref.types.html">Chapter&nbsp;9.&nbsp;Type System</a></th><td align="right" width="20%">&nbsp;<a accesskey="n" href="ref.types.override.html"><img src="images/next.gif" alt="Next"></a></td></tr><tr><td align="left" width="20%"><a href="ref.types.subtyping.html">9.3.&nbsp;Subtyping</a>&nbsp;</td><th align="center" width="60%">9.4.&nbsp;Adding Type Information</th><td align="right" width="20%"><a href="ref.types.override.html">9.5.&nbsp;Type Override</a>&nbsp;</td></tr></table></div><div class="section" title="9.4.&nbsp;Adding Type Information"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ref.types.typeinfo"></a>9.4.&nbsp;Adding Type Information</h2></div></div></div><a name="N4342C" class="indexterm"></a><p>
	The Orc typechecker uses a <a class="link" href="ref.types.metatheory.html#ref.types.metatheory.origin">type inference algorithm</a> to deduce
	type information from a program without any help from the programmer. In many contexts, the typechecker can
	find all of the type information it needs; however, there are some cases where extra information is needed.
	For this purpose, there are four kinds of <a name="N43435" class="indexterm"></a>
	type information that may be added to an Orc program.
	</p><p>
	Note that due to the <a class="link" href="ref.types.metatheory.html#ref.types.metatheory.erasure">erasure</a> property of the Orc type system,
	adding type information will never change the runtime behavior of the program.
	</p><div class="section" title="9.4.1.&nbsp;Explicit Type Arguments"><div class="titlepage"><div><div><h3 class="title"><a name="ref.types.typeinfo.explicitargs"></a>9.4.1.&nbsp;Explicit Type Arguments</h3></div></div></div><p>
		Type information may be added to a <a class="link" href="ref.types.polymorphism.html#ref.types.polymorphism.calls" title="9.2.3.&nbsp;Polymorphic calls">polymorphic</a> <a class="link" href="ref.expressions.call.html" title="2.4.&nbsp;Site and Function Calls">site or function call</a>
		by providing explicit type arguments. The typechecker can usually infer type arguments, 
		but there are certain cases where it does not have enough information, such as when 
		calling polymorphic factory sites like <a class="link" href="ref.stdlib.state.html#ref.stdlib.state.Channel"><code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Channel</span></code></a> or <a class="link" href="ref.stdlib.state.html#ref.stdlib.state.Ref"><code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Ref</span></code></a>.
	</p></div><div class="section" title="9.4.2.&nbsp;Function Type Information"><div class="titlepage"><div><div><h3 class="title"><a name="ref.types.typeinfo.function"></a>9.4.2.&nbsp;Function Type Information</h3></div></div></div><p>
		Whenever a <a class="link" href="ref.declarations.def.html" title="4.2.&nbsp;def: Define Function">function is defined</a>,
		in order for the typechecker to determine its type, 
		the definition must be accompanied by information about the argument types and return type
		of the function. If the function is polymorphic, the names of its type parameters must also be given.
		This is the same information that a <a class="link" href="ref.data.closure.html#ref.data.closure.type" title="1.9.1.&nbsp;Type">function type</a> carries.
		There are multiple ways to provide this information, and some of it can be inferred under certain conditions.
  </p><p>
	  The most comprehensive way to provide type information about a function is through a <a name="N43468" class="indexterm"></a><em class="firstterm">signature</em>.
		A signature precedes a function definition, providing a sequence of type parameters, a sequence of argument types,
		and a return type.
	</p><p>
	  </p><table cellpadding="5" width="100%" class="productionset" summary="EBNF"><tr><td><table cellpadding="0" width="99%" border="0" class="productionset" summary="EBNF productions"><tr><td width="3%" valign="top" align="left">[25]</td><td width="10%" valign="top" align="right"><a href="ref.syntax.EBNF.html#ebnf.declaration.signature"><a class="link" href="ref.types.typeinfo.html#ref.types.typeinfo.function" title="9.4.2.&nbsp;Function Type Information">DeclareSignature</a></a></td><td align="center" width="5%" valign="top"><code>::=</code></td><td width="52%" valign="top">
		    <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span></code> <a href="ref.syntax.EBNF.html#ebnf.variable">Variable</a> <a href="ref.syntax.EBNF.html#ebnf.typeparameters">TypeParameters</a><span class="bold"><strong>?</strong></span> <a href="ref.syntax.EBNF.html#ebnf.argumenttypes">ArgumentTypes</a> <a href="ref.syntax.EBNF.html#ebnf.returntype">ReturnType</a> 
		  </td><td width="30%" valign="top" align="left">&nbsp;</td></tr><tr><td width="3%" valign="top" align="left">[22]</td><td width="10%" valign="top" align="right"><a href="ref.syntax.EBNF.html#ebnf.declaration.def"><a class="link" href="ref.declarations.def.html" title="4.2.&nbsp;def: Define Function">DeclareDefinition</a></a></td><td align="center" width="5%" valign="top"><code>::=</code></td><td width="52%" valign="top">
		    <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span></code> <a href="ref.syntax.EBNF.html#ebnf.variable">Variable</a> <a href="ref.syntax.EBNF.html#ebnf.typeparameters">TypeParameters</a><span class="bold"><strong>?</strong></span> <a href="ref.syntax.EBNF.html#ebnf.parameters">Parameters</a> <a href="ref.syntax.EBNF.html#ebnf.returntype">ReturnType</a><span class="bold"><strong>?</strong></span> <a href="ref.syntax.EBNF.html#ebnf.guard">Guard</a><span class="bold"><strong>?</strong></span> <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">=</span></code> <a href="ref.syntax.EBNF.html#ebnf.expression">Expression</a> 
		  </td><td width="30%" valign="top" align="left">&nbsp;</td></tr></table></td></tr></table><p>
	</p><p>
	  Type information may also be written directly into a <a class="link" href="ref.declarations.def.html#ref.declarations.def.clauses" title="4.2.6.&nbsp;Clausal Definition">clause</a> of a function definition. 
	  For example, the following definitions are equivalent:

</p><pre class="programlisting">
<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-comment">{- Adding type information using a signature -}</span>
<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-site">min</span>(<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span>, <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span>) <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span>
<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-site">min</span>(<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span>,<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span>) <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">=</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">if</span> (<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">&lt;:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span>) <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">then</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">else</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span>

<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-comment">{- Inline type information -}</span>
<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-site">min</span>(<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span>, <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span>) <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">Number</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">=</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">if</span> (<span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">&lt;:</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span>) <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">then</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">x</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">else</span> <span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-variable">y</span>
</pre><p>

	</p><p>
	  If the function is not recursive, then the inline return type is optional, because the typechecker 
	  can infer the return type from the body expression.
	</p><p>
	  When writing a <a class="link" href="ref.expressions.lambda.html" title="2.8.&nbsp;lambda"><code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">lambda</span></code> expression</a>, type information
	  must be included in this way, since there is no way to write a separate signature. The return type 
	  is not needed, since a <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">lambda</span></code> will never be recursive. The parameter types are required and cannot
	  be inferred, except in one context: when a <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">lambda</span></code> expression appears as an argument to a call which
	  requires no other inference, then the argument types can be inferred from the type of the target.  
	</p></div><div class="section" title="9.4.3.&nbsp;Pattern Type Information"><div class="titlepage"><div><div><h3 class="title"><a name="ref.types.typeinfo.pattern"></a>9.4.3.&nbsp;Pattern Type Information</h3></div></div></div><p>
	</p><table cellpadding="5" width="100%" class="productionset" summary="EBNF"><tr><td><table cellpadding="0" width="99%" border="0" class="productionset" summary="EBNF productions"><tr><td width="3%" valign="top" align="left">[45]</td><td width="10%" valign="top" align="right"><a href="ref.syntax.EBNF.html#ebnf.pattern.withtypeinfo"><a class="link" href="ref.types.typeinfo.html#ref.types.typeinfo.pattern" title="9.4.3.&nbsp;Pattern Type Information">PatternWithTypeInformation</a></a></td><td align="center" width="5%" valign="top"><code>::=</code></td><td width="52%" valign="top">
		    <a href="ref.syntax.EBNF.html#ebnf.pattern">Pattern</a> <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span></code> <a href="ref.syntax.EBNF.html#ebnf.type">Type</a>
		  </td><td width="30%" valign="top" align="left">&nbsp;</td></tr></table></td></tr></table><p>
	</p><p>
	A <a class="link" href="ref.patterns.html" title="Chapter&nbsp;5.&nbsp;Patterns">pattern</a> may specify the type of values against which it may be matched. The typechecker can
	then verify this stated type, rather than attempting to infer it, which may provide enough type information to
	make other inferences possible or resolve ambiguities. Furthermore, adding extra type information makes it easier 
	to pinpoint the source of a typechecking failure. Note that this type information has no effect on
	the runtime match behavior of the pattern.
	</p></div><div class="section" title="9.4.4.&nbsp;Expression Type Information"><div class="titlepage"><div><div><h3 class="title"><a name="ref.types.typeinfo.expression"></a>9.4.4.&nbsp;Expression Type Information</h3></div></div></div><p>
		 </p><table cellpadding="5" width="100%" class="productionset" summary="EBNF"><tr><td><table cellpadding="0" width="99%" border="0" class="productionset" summary="EBNF productions"><tr><td width="3%" valign="top" align="left">[18]</td><td width="10%" valign="top" align="right"><a href="ref.syntax.EBNF.html#ebnf.expression.withtypeinfo"><a class="link" href="ref.types.typeinfo.html#ref.types.typeinfo.expression" title="9.4.4.&nbsp;Expression Type Information">WithTypeInformation</a></a></td><td align="center" width="5%" valign="top"><code>::=</code></td><td width="52%" valign="top">
		    <a href="ref.syntax.EBNF.html#ebnf.expression">Expression</a> <code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-operator">:</span></code> <a href="ref.syntax.EBNF.html#ebnf.type">Type</a>
		  </td><td width="30%" valign="top" align="left">&nbsp;</td></tr></table></td></tr></table><p>
   </p><p>
		 An expression may specify the type of values that it will <a class="link" href="ref.concepts.publish.html" title="8.1.&nbsp;Publication">publish</a>. The typechecker can
		 then verify this stated type, rather than attempting to infer it, which may provide enough type information to
		 make other inferences possible or resolve ambiguities. For example, the typechecker may not be able to infer the 
		 correct <a class="link" href="ref.types.subtyping.html#ref.types.subtyping.join" title="9.3.3.&nbsp;Join">join</a> type for a <a class="link" href="ref.combinators.parallel.html" title="3.1.&nbsp;Parallel Combinator">parallel combinator</a>,
		 but it is always able to check that both branches are <a class="link" href="ref.types.subtyping.html" title="9.3.&nbsp;Subtyping">subtypes</a> of an already provided type. 
		 Furthermore, adding extra type information makes it easier to pinpoint the source of a typechecking failure.
	 </p></div><div class="section" title="9.4.5.&nbsp;Related Links"><div class="titlepage"><div><div><h3 class="title"><a name="ref.types.typeinfo.links"></a>9.4.5.&nbsp;Related Links</h3></div></div></div><div class="itemizedlist" title="Related Reference Topics"><p class="title"><b>Related Reference Topics</b></p><ul class="itemizedlist" type="disc"><li class="listitem"><p><a class="link" href="ref.declarations.def.html" title="4.2.&nbsp;def: Define Function"><code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">def</span></code>:  Define Function</a></p></li><li class="listitem"><p><a class="link" href="ref.expressions.lambda.html" title="2.8.&nbsp;lambda"><code class="code"><span xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" class="hl-keyword">lambda</span></code> Expressions</a></p></li><li class="listitem"><p><a class="link" href="ref.patterns.html" title="Chapter&nbsp;5.&nbsp;Patterns">Patterns</a></p></li></ul></div><div class="itemizedlist" title="Related Tutorial Sections"><p class="title"><b>Related Tutorial Sections</b></p><ul class="itemizedlist" type="disc"><li class="listitem"><p><a href="../userguide/userguide.html#ug.additional.typecheck.moreinfo" class="olink">Adding Type Information</a></p></li></ul></div></div></div><script xmlns:od="http://orc.csres.utexas.edu/OrcDocBook.xsd" xmlns:db="http://docbook.org/ns/docbook" type="text/javascript" src="/orchard/orc.js"></script></body></html>